var photoPosts = [
    {
        id: '1',
        description: 'Женская сборная Беларуси выиграла эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    },
    {
        id: '2',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-24T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '3',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-22T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '4',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-10T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '5',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-03T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '6',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-03T23:00:00'),
        author: 'John Snow',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']}
    ,
    {
        id: '7',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-04-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '8',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '9',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-01-23T23:00:00'),
        author: 'John Snow',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '10',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-28T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    },
    {
        id: '11',
        description: 'Женская сборная Беларуси выиграла эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    },
    {
        id: '12',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-24T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '13',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-22T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '14',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-10T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '15',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-03T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '16',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-03T23:00:00'),
        author: 'John Snow',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']}
    ,
    {
        id: '17',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-04-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '18',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '19',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-01-23T23:00:00'),
        author: 'John Snow',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }
    ,
    {
        id: '20',
        description: 'Эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
        createdAt: new Date('2018-03-28T23:00:00'),
        author: 'Иванов Иван',
        photoLink: 'https://yandex.by/images/search?text=%D0%BA%D0%B0%D1%80%D1%82%D0%B8%D0%BD%D0%BA%D0%B8&img_url=https%3A%2F%2Fstmed.net%2Fsites%2Fdefault%2Ffiles%2Fsquirrel-wallpapers-25639-2177715.jpg&pos=0&rpt=simage&stype=image&lr=157&parent-reqid=1552306820603634-533477407658204781100039-vla1-3102&source=wiz',
        hashTags: ['#work', '#up', '#love'],
        likes: ['Alex Gold','Miss sunshine']
    }

];

let I = function () {
    let filterHelper = {
        author: function (list, author) {
            return list.filter(function (element) {
                return element.author === author;
            });
        },
        dateFrom: function (list, dateFrom) {
            var date = new Date(dateFrom);
            return list.filter(function (a) {
                return a.createdAt >= date;
            });
        },

        dateTo: function (list, dateTo) {
            var date = new Date(dateTo);
            return list.filter(function (a) {
                return a.createdAt < date;
            });
        },

        hashTags: function (list, hashTags) {
            let findHashTag = function (list, hashTag) {
                return list.filter(function (a) {
                    return a.hashTags.includes(hashTag)
                });
            };

            for (let i = 1; i < hashTags.length; i++) {
                list = findHashTag(list, hashTags[i]);
            }
            return list;

        }
    };

    return {
        checkId: function (a) {
            return a && (typeof a === 'string');
        },
        isUnique: function (id) {
            let res = photoPosts;
            if (this.checkId(id)) {
                res = res.filter(function (post) {
                    return post.id === id;
                })
            }
            return res.length === 0;
        },
        checkDescription: function (a) {
            return typeof a === 'string' && a.trim() !== '' && a.length < 200;
        },
        checkAuthor: function (a) {
            return typeof a === 'string' && a.trim() !== '';
        },
        checkPhotoLink: function (a) {
            return typeof a === 'string' && a.trim() !== '';
        },
        getPhotoPost: function (id) {
            if (this.checkId(id)) {
                let res = photoPosts;
                return  res.filter(function (post) {
                        if (post.id === id) {
                            return post;
                        }
                    }
                )[0];
            }
        },
        validatePhotoPost: function (photoPost) {
            if (typeof photoPost === "undefined") {
                return false;
            }
            let empty = photoPost.id && photoPost.description &&
                photoPost.createdAt && photoPost.author &&
                photoPost.photoLink;
            if (empty) {
                return this.checkId(photoPost.id) &&
                    this.checkDescription(photoPost.description) &&
                    this.checkAuthor(photoPost.author) &&
                    this.checkPhotoLink(photoPost.photoLink);
            }
            return false;
        },
        addPhotoPost: function (a) {
            if (this.validatePhotoPost(a)) {
                if (this.isUnique(a.id)) {
                    photoPosts.unshift(a);
                    return true;
                }
            }
            return false;
        },
        editPhotoPost: function (id, photoPost) {
            let currentPhotoPost = this.getPhotoPost(id);
            let flag = false;
            if (this.validatePhotoPost(currentPhotoPost)) {
                if (this.checkDescription(photoPost.description)) {
                    currentPhotoPost.description = photoPost.description;
                    flag = true;
                }
                if (this.checkPhotoLink(photoPost.photoLink)) {
                    currentPhotoPost.photoLink = photoPost.photoLink;
                    flag = true;
                }
            }

            return flag;
        },
        removePhotoPost: function (id) {
            let flag = false;
            if (this.checkId(id)) {
                photoPosts.forEach(function (item, i, photoPosts) {
                    if (item.id === id) {
                        photoPosts.splice(i, 1);
                        flag = true;
                    }
                });

            }
            return flag;
        },
        getPhotoPosts: function (skip, top, filterConfig) {
            var skip = skip || 0;
            var top = top || 10;
            var filteredPosts = photoPosts.slice(0);
            Object.keys(filterConfig).forEach(function (field) {
                filteredPosts = filterHelper[field](filteredPosts, filterConfig[field])
            });
            return filteredPosts.slice(skip, top);
        },

    }
}();
console.log(I.getPhotoPost('9'));
console.log(I.isUnique('2'));
console.log(I.getPhotoPosts(0, 10, {author: 'Mr. Snow'}));
console.log(I.removePhotoPost('6'));
console.log(I.editPhotoPost('1', { photoLink: 'http://haradok.info/static/news/5/4565/preview.jpg'}));
console.log(I.addPhotoPost({
    id: '21',
    description: 'Женская сборная Беларуси выиграла эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
    createdAt: new Date('2018-02-23T23:00:00'),
    author: 'Иванов Иван',
    photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg'
}));
console.log(I.validatePhotoPost({
    id: '1',
    description: 'Женская сборная Беларуси выиграла эстафету в рамках соревнований по биатлону на Олимпийских играх в Пхёнчхане!!!',
    createdAt: new Date('2018-02-23T23:00:00'),
    author: 'Иванов Иван',
    photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg'
}));


